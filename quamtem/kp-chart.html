<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>KP Astrology Book Generator (NASA Horizons Real Planets + KP UI Options)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { margin:0; padding:0; background:linear-gradient(135deg,#f2f5fa 0,#eaf0ff 100%); font-family:'Segoe UI',Arial,sans-serif; }
    .container { max-width: 540px; margin: 40px auto 32px auto; padding:24px 16px 26px 16px; background:#fff; border-radius: 15px; box-shadow: 0 6px 36px #3451bf19, 0 1.5px 7px #b1b1b117;}
    h2 { color:#3451bf; margin-top:0;text-align:center; }
    label { display:block; margin-top:9px; margin-bottom:2px; font-weight:500;}
    input, select, button { width:100%; padding:8px 11px; margin-bottom:9px; border-radius:7px; border:1px solid #dbeafe; background:#f8fafc; font-size:1em;}
    input:focus,select:focus{border-color:#3451bf;}
    #drawBtn { background: linear-gradient(90deg, #3451bf 80%, #5e7bdf 100%); color: #fff; font-weight: 600; letter-spacing: 1px; cursor:pointer; border:none; margin-top:8px; border-radius:8px; font-size:1.07em; padding:12px 0; transition:background .18s; box-shadow:0 2px 8px #3451bf13;}
    #wheelBox { display:flex; justify-content:center; margin-top:22px; }
    #analysis { background:#f8f8fc; border-left:3px solid #3451bf; margin-top:22px; padding:13px 16px 12px 16px; font-size:1.09em; border-radius:7px; color:#26334d; min-height:40px;}
    .footer { text-align:center; color:#3451bf; font-size:1em; letter-spacing:1px; opacity:0.88; margin-top:28px;}
    @media(max-width:600px){
      .container{max-width:99vw;padding:4vw;}
      #wheelBox svg{width:95vw !important;height:95vw !important;}
      h2 { font-size: 1.33em;}
    }
    #placeGroup {display:flex;gap:4px;}
    #geocodeBtn {width:auto;background:#4a5fbf;color:#fff;padding:7px 16px;border-radius:7px;margin-bottom:0;font-size:1em;}
    /* KP Options UI */
    #astroOptions {background:#f7f8fd;border-radius:10px;padding:16px 13px 9px 13px;margin-bottom:14px;border:1px solid #e4e7ed;}
    #astroOptions h3 {margin:0 0 10px 0;font-size:1.15em;color:#3451bf;}
    #astroOptions label {font-weight:500;}
    #astroOptions select, #astroOptions input[type="checkbox"] {margin-bottom:5px;}
  </style>
</head>
<body>
  <div class="container">
    <h2>KP Astrology Book Generator (Real NASA Planets)</h2>
    <!-- KP/Vedic/Western/House Option UI (does not affect NASA data) -->
    <div id="astroOptions">
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:10px;">
        <span style="font-size:1.32em; color:#3451bf;">ðŸ”­</span>
        <h3>KP Chart Options</h3>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;">
        <div style="flex:1;min-width:140px;">
          <label>Chart Type</label>
          <select id="chartType">
            <option value="kp" selected>KP (Krishnamurti)</option>
            <option value="vedic">Vedic</option>
            <option value="western">Western</option>
          </select>
        </div>
        <div style="flex:1;min-width:140px;">
          <label>Ayanamsa</label>
          <select id="ayanamsa">
            <option value="kp" selected>KP</option>
            <option value="lahiri">Lahiri</option>
            <option value="raman">Raman</option>
            <option value="fagan">Fagan/Bradley</option>
          </select>
        </div>
        <div style="flex:1;min-width:140px;">
          <label>House System</label>
          <select id="houseSystem">
            <option value="kp" selected>KP (Placidus)</option>
            <option value="equal">Equal</option>
            <option value="whole">Whole Sign</option>
          </select>
        </div>
      </div>
      <div style="display
