<div style="margin:12px 0">
  <label>Report: </label>
  <select id="lang"></select>
  <button id="refresh">Refresh now</button>
</div>
<pre id="reportBox" style="white-space:pre-wrap;border:1px solid #ccc;padding:10px;border-radius:8px;min-height:240px;direction:auto"></pre>

<script>
const LANGS = [
  ["en","English"],
  ["si","සිංහල"],
  ["ta","தமிழ் (Tamil)"],
  ["hi","हिन्दी (Hindi)"],
  ["ar","العربية (Arabic)"],
  ["es","Español (Spanish)"],
  ["fr","Français (French)"],
  ["de","Deutsch (German)"],
  ["zh-CN","中文 (Chinese)"],
  ["ja","日本語 (Japanese)"]
];

const supported = LANGS.map(x=>x[0]);
const langSel = document.getElementById('lang');

// populate dropdown dynamically
LANGS.forEach(([v,l])=>{
  const o=document.createElement('option');
  o.value=v;
  o.textContent=l;
  langSel.appendChild(o);
});

async function loadReport(lang){
  const file = lang==='en' ? 'report_en.txt' : `report_${lang}.txt`;
  try{
    const res = await fetch(`${file}?v=${Date.now()}`); // cache-bust
    if(!res.ok) throw new Error(res.status);
    document.getElementById('reportBox').textContent = await res.text();
  }catch(e){
    document.getElementById('reportBox').textContent =
      `Report not found for "${lang}". Looking for: ${file}`;
  }
}

langSel.addEventListener('change', e=>loadReport(e.target.value));
document.getElementById('refresh').addEventListener('click', ()=>loadReport(langSel.value));

// auto select browser lang
const userLang = (navigator.language || "en");
const pick = supported.includes(userLang) ? userLang : "en";
langSel.value = pick;
loadReport(pick);
</script>
