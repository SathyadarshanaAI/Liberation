<script>
(function(){
  const logBox=document.createElement("div");
  logBox.id="buddhiFusion";
  logBox.innerHTML=`
  <div id="bfHeader" style="background:#00111a;padding:4px;border-radius:8px 8px 0 0;">
    üß† <b>Buddhi Fusion Monitor v6.2 PRO</b>
    <button id="bfToggle" style="float:right;margin-left:6px;">‚¨á</button>
    <button id="bfSave" style="float:right;">üíæ</button>
  </div>
  <div id="bfBody">Initializing...</div>`;
  logBox.style.cssText=`
    position:fixed;bottom:10px;left:10px;right:10px;
    background:rgba(0,0,0,.9);color:#16f0a7;
    font-family:monospace;font-size:12px;
    border:1px solid #00e5ff;border-radius:10px;
    z-index:999999;box-shadow:0 0 12px #00e5ff;
    max-height:240px;overflow:hidden;`;
  document.body.appendChild(logBox);

  const body=logBox.querySelector("#bfBody");
  const toggle=logBox.querySelector("#bfToggle");
  const save=logBox.querySelector("#bfSave");
  let collapsed=false;

  toggle.onclick=()=>{
    collapsed=!collapsed;
    body.style.display=collapsed?"none":"block";
    toggle.textContent=collapsed?"‚¨Ü":"‚¨á";
  };

  save.onclick=()=>{
    const blob=new Blob([body.innerText],{type:"text/plain"});
    const a=document.createElement("a");
    a.href=URL.createObjectURL(blob);
    a.download="buddhi_log.txt";
    a.click();
  };

  function log(msg,color="#16f0a7"){
    const t=new Date().toLocaleTimeString();
    body.innerHTML+=`<div style="color:${color}">[${t}] ${msg}</div>`;
    body.scrollTop=body.scrollHeight;
  }

  // üß† Error hooks
  window.onerror=(m,s,l)=>log(`‚ùå ${m} in ${s?.split("/").pop()||"?"}@${l}`,"#ff6666");
  window.addEventListener("unhandledrejection",e=>
    log(`‚ö†Ô∏è Promise: ${e.reason?.message||e.reason}`,"#ffaa33"));
  window.addEventListener("load",()=>log("‚úÖ Error hooks active.","#16f0a7"));

  log("üß† Buddhi Fusion Monitor v6.2 PRO initialized.");

  // üß© live module check + heartbeat
  setInterval(()=>{
    try{
      if(window.modulesLoaded){
        const c=Object.keys(window.modulesLoaded).length;
        log(`üß© Modules verified: ${c}`,"#00e5ff");
      }else{
        log("‚öôÔ∏è Checking system integrity...","#00cc99");
      }
    }catch(e){log("‚ùó Check error: "+e.message,"#ff4444");}
  },4000);
})();
</script>
