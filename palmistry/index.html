<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ–ï¸ Sathyadarshana Quantum Palm Analyzer Â· V9.7 Ultimate Fusion</title>
<link rel="icon" href="./assets/icon.png" />
<style>
:root { --bg:#0b0f16; --card:#101820; --neon:#00e5ff; --pri:#16f0a7; }
body {
  margin:0; background:var(--bg); color:#e6f0ff;
  font-family:'Segoe UI',sans-serif; text-align:center;
}
h1 { color:var(--neon); margin-top:20px; text-shadow:0 0 12px var(--neon); }
.wrap { display:flex; flex-wrap:wrap; justify-content:center; gap:20px; margin:20px auto; }
.camCol {
  background:var(--card); border-radius:20px; padding:16px;
  width:90%; max-width:340px; box-shadow:0 0 14px #000;
}
video,canvas {
  width:100%; border-radius:12px; background:#000; object-fit:contain;
}
button {
  margin:6px; padding:8px 16px; border:none; border-radius:8px;
  background:var(--neon); color:#000; font-weight:600;
  cursor:pointer; box-shadow:0 0 10px var(--neon); transition:0.2s;
}
button:active { transform:scale(0.94); }
#status { margin-top:15px; color:var(--pri); font-weight:500; }
#reportBox {
  background:#0f172a; color:#e0f2fe; margin:20px auto; padding:14px;
  width:90%; max-width:700px; border-radius:12px;
  box-shadow:0 0 15px #00e5ff80; text-align:left; white-space:pre-wrap;
}
</style>
</head>
<body>
<h1>ğŸ•‰ï¸ Sathyadarshana Quantum Palm Analyzer Â· V9.7 Ultimate Fusion</h1>

<div class="wrap">
  <div class="camCol">
    <h3>Left Hand (à¶´à·™à¶» à¶·à·€à¶º)</h3>
    <video id="vidLeft" autoplay playsinline muted></video>
    <canvas id="canvasLeft"></canvas><br>
    <button id="startLeft">ğŸ“· Start</button>
    <button id="captureLeft">ğŸ“¸ Capture</button>
    <button id="torchLeft">ğŸ”¦ Torch</button>
  </div>

  <div class="camCol">
    <h3>Right Hand (à¶¸à·™à·’ à¶·à·€à¶º)</h3>
    <video id="vidRight" autoplay playsinline muted></video>
    <canvas id="canvasRight"></canvas><br>
    <button id="startRight">ğŸ“· Start</button>
    <button id="captureRight">ğŸ“¸ Capture</button>
    <button id="miniReport">ğŸ” Mini Report</button>
    <button id="fullReport">ğŸ“œ Full Report</button>
    <button id="torchRight">ğŸ”¦ Torch</button>
  </div>
</div>

<p id="status">Initializing...</p>
<div id="reportBox">Report will appear here...</div>

<!-- === Script Zone === -->
<script type="module">
import { generateFullReport } from './report.js';

const statusEl = document.getElementById("status");
const reportBox = document.getElementById("reportBox");

let leftStream=null, rightStream=null;

// --- CAMERA SETUP ---
async function startCamera(side){
  const vid=document.getElementById(side==="left"?"vidLeft":"vidRight");
  try{
    const stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});
    vid.srcObject=stream;
    if(side==="left") leftStream=stream; else rightStream=stream;
    statusEl.textContent=`âœ… ${side.toUpperCase()} camera started`;
  }catch(e){ statusEl.textContent=`âŒ ${e.message}`; }
}

// --- CAPTURE FRAME ---
function captureFrame(side){
  const vid=document.getElementById(side==="left"?"vidLeft":"vidRight");
  const canvas=document.getElementById(side==="left"?"canvasLeft":"canvasRight");
  const ctx=canvas.getContext("2d");
  canvas.width=vid.videoWidth||640;
  canvas.height=vid.videoHeight||480;
  ctx.drawImage(vid,0,0,canvas.width,canvas.height);
  statusEl.textContent=`ğŸ“¸ ${side.toUpperCase()} hand captured`;
}

// --- TORCH CONTROL ---
async function toggleTorch(side){
  const stream=side==="left"?leftStream:rightStream;
  if(!stream) return alert("Start the camera first!");
  const track=stream.getVideoTracks()[0];
  const caps=track.getCapabilities();
  if(caps.torch){
    const cur=track.getSettings().torch||false;
    await track.applyConstraints({advanced:[{torch:!cur}]});
    statusEl.textContent=`ğŸ”¦ Torch ${!cur?'ON':'OFF'} (${side})`;
  } else alert("Torch not supported");
}

// --- REPORT GENERATION ---
document.getElementById("miniReport").onclick=()=>{
  reportBox.textContent="ğŸ§  Mini Analysis: Lines show balanced intellect and emotion.";
};
document.getElementById("fullReport").onclick=()=>{
  const left="Strong Life Line, deep Heart curve";
  const right="Steady Fate Line, balanced Head flow";
  reportBox.textContent=generateFullReport(left,right);
};

// --- BUTTON EVENTS ---
document.getElementById("startLeft").onclick=()=>startCamera("left");
document.getElementById("startRight").onclick=()=>startCamera("right");
document.getElementById("captureLeft").onclick=()=>captureFrame("left");
document.getElementById("captureRight").onclick=()=>captureFrame("right");
document.getElementById("torchLeft").onclick=()=>toggleTorch("left");
document.getElementById("torchRight").onclick=()=>toggleTorch("right");
</script>
</body>
</html>
