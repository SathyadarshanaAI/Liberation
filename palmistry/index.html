<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>üñêÔ∏è Sathyadarshana Quantum Palm Analyzer ¬∑ V12.9 Equal Window Lock Edition</title>
<style>
:root{
  --bg:#0b0f16;
  --card:#101820;
  --neon:#00e5ff;
  --pri:#16f0a7;
  --gold:#FFD700;
}
body{
  margin:0;
  background:var(--bg);
  color:#e6f0ff;
  font-family:'Segoe UI',sans-serif;
  text-align:center;
}
h1{
  color:var(--neon);
  text-shadow:0 0 15px var(--neon);
  margin-top:18px;
  font-size:1.4rem;
}
.camWrap{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:20px;
  margin:20px auto;
  width:95%;
  max-width:720px;
  position:relative;
}
.camBox{
  position:relative;
  width:320px;
  background:var(--card);
  border-radius:16px;
  padding:10px;
  box-shadow:0 0 20px #00e5ff22;
  overflow:hidden;
}
video, .lockedImg{
  width:100%;
  height:auto;
  aspect-ratio:3/4;
  border-radius:12px;
  background:#000;
  object-fit:cover;
}
.goldenBeam{
  position:absolute;
  top:-100%;
  left:0;
  width:100%;
  height:100%;
  background:linear-gradient(180deg,transparent 0%,rgba(255,215,0,0.45) 50%,transparent 100%);
  box-shadow:0 0 20px var(--gold);
  opacity:0;
  pointer-events:none;
}
button{
  background:var(--neon);
  border:none;
  color:#000;
  font-weight:bold;
  padding:8px 16px;
  border-radius:8px;
  margin-top:8px;
}
button:hover{background:var(--pri);color:#fff;}
#reportBox{
  background:#0d131b;
  border-radius:14px;
  padding:12px;
  margin:20px auto;
  width:90%;
  max-width:640px;
  box-shadow:0 0 12px #00e5ff33 inset;
  text-align:left;
  font-size:0.9rem;
  line-height:1.5;
}
</style>
</head>
<body>
<h1>üïâÔ∏è Sathyadarshana Quantum Palm Analyzer ¬∑ V12.9</h1>

<div class="camWrap">
  <div class="camBox" id="leftBox">
    <h3>Left Hand</h3>
    <video id="vidLeft" autoplay playsinline muted></video>
    <div class="goldenBeam" id="beamLeft"></div>
    <button id="btnLeft">üì∏ Capture Left</button>
  </div>

  <div class="camBox" id="rightBox">
    <h3>Right Hand</h3>
    <video id="vidRight" autoplay playsinline muted></video>
    <div class="goldenBeam" id="beamRight"></div>
    <button id="btnRight">üì∏ Capture Right</button>
  </div>
</div>

<div id="reportBox">
  <b>AI Insight:</b>
  <p id="reportText">Awaiting capture...</p>
</div>

<script>
const vidL=document.getElementById("vidLeft");
const vidR=document.getElementById("vidRight");
const report=document.getElementById("reportText");
let stream,leftLocked=false,rightLocked=false,leftImg=null,rightImg=null;

// Use one camera stream for both windows
async function initCam(){
  try{
    stream=await navigator.mediaDevices.getUserMedia({
      video:{
        facingMode:"environment",
        width:{ideal:1280},
        height:{ideal:960},
        aspectRatio:1.333
      }
    });
    vidL.srcObject=stream;
    vidR.srcObject=stream;
  }catch(e){alert("Camera not accessible: "+e.message);}
}
initCam();

// Capture buttons
document.getElementById("btnLeft").onclick=()=>capture("left");
document.getElementById("btnRight").onclick=()=>capture("right");

// Capture logic
function capture(side){
  const vid=side==="left"?vidL:vidR;
  const beam=document.getElementById(side==="left"?"beamLeft":"beamRight");
  const canvas=document.createElement("canvas");
  canvas.width=vid.videoWidth||640;
  canvas.height=vid.videoHeight||480;
  const ctx=canvas.getContext("2d");
  ctx.drawImage(vid,0,0,canvas.width,canvas.height);
  const img=canvas.toDataURL("image/png");

  if(side==="left"){
    leftLocked=true; leftImg=img;
    vid.replaceWith(Object.assign(document.createElement("img"),{src:img,className:"lockedImg",id:"vidLeft"}));
    drawLines(ctx,canvas,"left");
    report.textContent="‚úÖ Left hand locked. Capture right hand next.";
  }else{
    rightLocked=true; rightImg=img;
    animateDualBeams(canvas,ctx);
  }
}

// Equal golden beam animation
function animateDualBeams(canvas,ctx){
  const beamL=document.getElementById("beamLeft");
  const beamR=document.getElementById("beamRight");
  beamL.style.opacity=1; beamR.style.opacity=1;
  let y=0, h=canvas.height;
  const id=setInterval(()=>{
    y+=5; beamL.style.top=y+"px"; beamR.style.top=y+"px";
    if(y>h){
      clearInterval(id);
      beamL.style.opacity=0; beamR.style.opacity=0;
      stopCam();
      drawLines(ctx,canvas,"right");
      analyzeBoth();
    }
  },10);
}

function stopCam(){
  stream?.getTracks().forEach(t=>t.stop());
  console.log("üé• Camera stream stopped (dual).");
}

function drawLines(ctx,canvas,side){
  const w=canvas.width,h=canvas.height;
  const warm=["#FFD700","#FF8C00","#FF4500","#FFA07A","#FF6347","#E9967A","#FFB347","#FF7F50"];
  const cool=["#00CED1","#1E90FF","#7B68EE","#ADFF2F","#00FA9A","#5F9EA0","#8A2BE2","#00BFFF"];
  const colors=side==="left"?warm:cool;
  for(let i=0;i<8;i++){
    ctx.strokeStyle=colors[i];
    ctx.lineWidth=2;
    ctx.beginPath();const y=h*(i+1)/9;
    ctx.moveTo(0,y);ctx.lineTo(w,y);ctx.stroke();
  }
}

function analyzeBoth(){
  if(!leftImg||!rightImg)return;
  report.innerHTML="üß† Analyzing both hands...";
  setTimeout(()=>{
    report.innerHTML=`
      <div style="display:flex;flex-wrap:wrap;gap:10px;justify-content:center;">
        <img src="${leftImg}" width="150" style="border-radius:8px;">
        <img src="${rightImg}" width="150" style="border-radius:8px;">
      </div>
      <b>AI Buddhi Report:</b>
      <p>Both hands scanned equally. True symmetry detected.<br>
      Energy fields balanced ‚Äî Golden resonance stable ‚úÖ</p>`;
  },2500);
}
</script>
</body>
</html>
