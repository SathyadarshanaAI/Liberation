<!DOCTYPE html>
<html lang="si">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dual Camera ¬∑ Left & Mirrored Right</title>
<style>
  :root{--bg:#0b0f16;--card:#101820;--pri:#16f0a7}
  *{box-sizing:border-box}  body{margin:0;background:var(--bg);color:#e6f0ff;font-family:system-ui}
  header{padding:12px 16px;text-align:center}
  .wrap{max-width:980px;margin:0 auto;padding:10px}
  .grid{display:grid;gap:12px;grid-template-columns:1fr;align-items:start}
  @media (min-width:720px){ .grid{grid-template-columns:1fr 1fr} }
  .card{background:var(--card);border-radius:16px;padding:10px;border:1px solid #1e2a3a}
  .title{display:flex;align-items:center;justify-content:space-between;margin:0 0 8px}
  canvas{width:100%;height:auto;border-radius:12px;background:#000}
  .btns{display:flex;gap:8px;flex-wrap:wrap}
  button{background:var(--pri);border:none;color:#001b12;padding:10px 14px;border-radius:12px;font-weight:700}
  small{opacity:.85}
  .note{margin:10px 0 0;font-size:13px;opacity:.9}
  /* right view is mirrored via drawing, but keep label hint */
  .label{font-weight:700;color:#9be8cf}
</style>
</head>
<body>
  <header>
    <h2>Left view + Mirrored Right view (no app.js)</h2>
  </header>

  <div class="wrap">
    <div class="btns">
      <button id="startBtn">üì∑ Start camera</button>
      <button id="stopBtn" disabled>‚ñ† Stop</button>
    </div>
    <p class="note">‡∂Ö‡∂±‡∑ô‡∂ö‡∑î‡∂≠‡∑ä browser ‡∑Ä‡∂Ω‡∂Ø‡∑ì ‚ÄúAllow camera‚Äù ‡∂Ø‡∑ô‡∂±‡∑ä‡∂±. Android ‡∑Ñ‡∑í zoom/rotate ‡∂±‡∑ê‡∂≠‡∑í‡∑Ä <i>playsinline</i> ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂∏‡∑í‡∂±‡∑ä √ßiz‡∂±‡∑Ä‡∑è.</p>

    <div class="grid">
      <div class="card">
        <div class="title"><span class="label">LEFT ‚Äî Normal</span><small id="wh1">‚Äì</small></div>
        <canvas id="left"></canvas>
      </div>
      <div class="card">
        <div class="title"><span class="label">RIGHT ‚Äî Mirrored (Flip)</span><small id="wh2">‚Äì</small></div>
        <canvas id="right"></canvas>
      </div>
    </div>
  </div>

  <!-- hidden video only to read the camera frames -->
  <video id="src" autoplay playsinline muted style="display:none"></video>

<script>
(() => {
  const video = document.getElementById('src');
  const cLeft = document.getElementById('left');
  const cRight = document.getElementById('right');
  const wh1 = document.getElementById('wh1');
  const wh2 = document.getElementById('wh2');
  const startBtn = document.getElementById('startBtn');
  const stopBtn  = document.getElementById('stopBtn');
  let stream = null, rafId = 0, running = false;

  async function start() {
    try {
      stream = await navigator.mediaDevices.getUserMedia({
        video: { facingMode: "environment" }, audio: false
      });
      video.srcObject = stream;
      await video.play();

      const w = video.videoWidth || 1280;
      const h = video.videoHeight || 720;
      [cLeft, cRight].forEach(c => { c.width = w; c.height = h; });
      wh1.textContent = `${w}√ó${h}`;
      wh2.textContent = `${w}√ó${h}`;

      running = true;
      startBtn.disabled = true; stopBtn.disabled = false;
      draw();
    } catch (e) {
      alert("Camera error: " + e.message);
    }
  }

  function stop() {
    running = false;
    cancelAnimationFrame(rafId);
    if (stream) {
      stream.getTracks().forEach(t => t.stop());
      stream = null;
    }
    startBtn.disabled = false; stopBtn.disabled = true;
  }

  function draw() {
    if (!running) return;
    const L = cLeft.getContext('2d');
    const R = cRight.getContext('2d');
    const w = cLeft.width, h = cLeft.height;

    // LEFT: normal
    L.drawImage(video, 0, 0, w, h);

    // RIGHT: mirrored (flip horizontally)
    R.save();
    R.scale(-1, 1);           // mirror
    R.drawImage(video, -w, 0, w, h);
    R.restore();

    rafId = requestAnimationFrame(draw);
  }

  startBtn.addEventListener('click', start);
  stopBtn.addEventListener('click', stop);
})();
</script>
</body>
</html>
