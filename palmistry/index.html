<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Quantum Palm Analyzer v4.3.1</title>
<style>
:root{--bg:#0b0f16;--card:#0f172a;--neon:#00e5ff;--pri:#16f0a7;--mut:#a9c2da}
*{box-sizing:border-box}
body{margin:0;background:radial-gradient(1200px 800px at 50% -10%,#0e2133,#0b0f16);color:#e6f0ff;font-family:system-ui,Segoe UI,Inter,Arial}
h1{margin:12px 0 6px;text-align:center;color:var(--neon)}
.wrap{max-width:960px;margin:0 auto;padding:10px}

/* --- Big buttons (pill) --- */
.btn,button,a{background:#0d1522;color:#c7e8ff;border:1px solid #1a3a55;border-radius:22px;
  padding:12px 16px;font-weight:800;cursor:pointer;text-decoration:none;display:inline-flex;gap:8px;align-items:center}
.btn:hover,button:hover,a:hover{background:#00e5ff;color:#001015;border-color:#00e5ff}
.toolbar{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin:8px 0 12px}

/* --- Camera (taller, responsive) --- */
.camWrap{display:grid;place-items:center}
.camBox{position:relative;width:min(96vw,720px);aspect-ratio:3/4;border-radius:16px;border:2px solid #00d0ff;overflow:hidden;background:#000}
.camBox video,.camBox canvas,.camBox .aura{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;border-radius:16px}
#video[hidden]{display:none}
.aura{mix-blend-mode:screen;background:conic-gradient(from 0deg,#00e5ff88,#16f0a788,#9a6bff88,#00e5ff88);animation:spin 6s linear infinite;opacity:.7}
@keyframes spin{to{transform:rotate(360deg)}}

/* --- Panels --- */
.card{background:linear-gradient(180deg,#101a2b,#0c1320);border:1px solid #133149;border-radius:16px;padding:14px;margin-top:12px}

/* --- Bars with Sinhala labels --- */
.lines{display:grid;grid-template-columns:1fr;gap:8px}
.row{display:grid;grid-template-columns:220px 1fr;gap:10px;align-items:center}
.badge{display:inline-block;background:#0b1320;border:1px solid #17324a;border-radius:10px;padding:3px 8px;font-size:12px;color:#9edcff}
.bar{background:#0b1320;height:12px;border-radius:10px;overflow:hidden}
.bar>span{display:block;height:100%;transform-origin:left center;transform:scaleX(0);transition:transform 900ms ease}
.bar.h  >span{background:linear-gradient(90deg,#ff6b6b,#ff3b3b)}
.bar.hh >span{background:linear-gradient(90deg,#60a5fa,#3b82f6)}
.bar.l  >span{background:linear-gradient(90deg,#34d399,#10b981)}
.bar.f  >span{background:linear-gradient(90deg,#f59e0b,#fbbf24)}
.bar.s  >span{background:linear-gradient(90deg,#f97316,#fb923c)}
.bar.mer>span{background:linear-gradient(90deg,#a78bfa,#8b5cf6)}
.bar.mar>span{background:linear-gradient(90deg,#f472b6,#ec4899)}

/* Color legend (‚Äúpeacher‚Äù) */
.legend{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:8px}
.legend .item{display:flex;align-items:center;gap:8px;font-size:14px;color:#d7e8ff}
.sw{width:14px;height:14px;border-radius:4px}
.sw.h{background:#ff4f56}.sw.hh{background:#5aa2ff}.sw.l{background:#15c194}
.sw.f{background:#f6a911}.sw.s{background:#fb8a2d}.sw.mer{background:#8b5cf6}.sw.mar{background:#ec4899}

/* Radar */
#radar{display:block;margin:10px auto;background:#0b1320;border:1px solid #17324a;border-radius:12px}

/* Translate bar (kept) */
.langbar{display:flex;flex-wrap:wrap;gap:6px;justify-content:center;margin:6px 0}
.langbar button{background:#0b1320;border:1px solid #17324a;color:#9edcff;border-radius:999px;padding:6px 10px;font-weight:700}
.langbar button:hover{background:#00e5ff;color:#001015}
#google_translate_element{display:inline-block;margin-left:6px}
</style>
</head>
<body>
  <h1>Quantum Palm Analyzer v4.3.1</h1>

  <!-- Language quick switch -->
  <div class="langbar">
    <button data-lang="en">English</button><button data-lang="si">‡∑É‡∑í‡∂Ç‡∑Ñ‡∂Ω</button>
    <button data-lang="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button><button data-lang="de">Deutsch</button>
    <button data-lang="it">Italiano</button><button data-lang="ja">Êó•Êú¨Ë™û</button>
    <button data-lang="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button><button data-lang="zh-CN">‰∏≠Êñá</button>
    <button data-lang="fr">Fran√ßais</button><button data-lang="es">Espa√±ol</button>
    <button data-lang="tr">T√ºrk√ße</button><button data-lang="ru">–†—É—Å—Å–∫–∏–π</button>
    <span id="google_translate_element"></span>
  </div>

  <!-- Toolbar (bigger buttons) -->
  <div class="toolbar">
    <a class="btn" href="../astrology.html">‚Üê Astrology</a>
    <button class="btn" id="startCam">üì∑ Start Camera</button>
    <button class="btn" id="capture">Capture</button>
    <label class="btn" for="filePick">Upload Photo</label>
    <input id="filePick" type="file" accept="image/*" hidden/>
    <button class="btn" id="analyze">Analyze</button>
    <a class="btn" href="./report.html">PDF Report</a>
  </div>

  <div class="wrap">
    <!-- Camera -->
    <div class="card">
      <div class="camWrap">
        <div class="camBox" id="camBox">
          <video id="video" playsinline autoplay muted hidden></video>
          <canvas id="canvas"></canvas>
          <div class="aura" aria-hidden="true"></div>
        </div>
      </div>
      <div style="text-align:center;margin-top:6px" id="status" class="badge">No image yet</div>
    </div>

    <!-- Bars + Legend -->
    <div class="card">
      <div class="badge" id="conf">Confidence ‚Äî</div>
      <div class="lines" id="lines">
        <div class="row"><div>‚ù§Ô∏è ‡∑Ñ‡∑ò‡∂Ø ‡∂ª‡∑ö‡∂õ‡∑è‡∑Ä (Heart)</div>     <div class="bar h"><span id="b0"></span></div></div>
        <div class="row"><div>üß† ‡∂†‡∑í‡∂≠‡∑ä‡∂≠/‡∂∏‡∑É‡∑ä‡∂≠‡∑í‡∑Ç‡∑ä‡∂ö (Head)</div><div class="bar hh"><span id="b1"></span></div></div>
        <div class="row"><div>üåø ‡∂¢‡∑ì‡∑Ä‡∂± ‡∂ª‡∑ö‡∂õ‡∑è‡∑Ä (Life)</div>     <div class="bar l"><span id="b2"></span></div></div>
        <div class="row"><div>üúÇ ‡∂∑‡∑è‡∂ú‡∑ä‚Äç‡∂∫ ‡∂ª‡∑ö‡∂õ‡∑è‡∑Ä (Fate)</div>   <div class="bar f"><span id="b3"></span></div></div>
        <div class="row"><div>‚òÄÔ∏è ‡∑É‡∑ñ‡∂ª‡∑ä‡∂∫ (Sun)</div>             <div class="bar s"><span id="b4"></span></div></div>
        <div class="row"><div>‚òø ‡∂∂‡∑î‡∂∞/‡∑É‡∑î‡∑Ä (Mercury)</div>       <div class="bar mer"><span id="b5"></span></div></div>
        <div class="row"><div>üíç ‡∑Ä‡∑í‡∑Ä‡∑è‡∑Ñ (Marriage)</div>        <div class="bar mar"><span id="b6"></span></div></div>
      </div>

      <!-- Color Legend (re-added) -->
      <div class="legend">
        <div class="item"><span class="sw h"></span>‡∑Ñ‡∑ò‡∂Ø (Heart)</div>
        <div class="item"><span class="sw hh"></span>‡∂†‡∑í‡∂≠‡∑ä‡∂≠/Head</div>
        <div class="item"><span class="sw l"></span>‡∂¢‡∑ì‡∑Ä‡∂± (Life)</div>
        <div class="item"><span class="sw f"></span>‡∂∑‡∑è‡∂ú‡∑ä‚Äç‡∂∫ (Fate)</div>
        <div class="item"><span class="sw s"></span>‡∑É‡∑ñ‡∂ª‡∑ä‡∂∫ (Sun)</div>
        <div class="item"><span class="sw mer"></span>‡∂∂‡∑î‡∂∞/‡∑É‡∑î‡∑Ä (Mercury)</div>
        <div class="item"><span class="sw mar"></span>‡∑Ä‡∑í‡∑Ä‡∑è‡∑Ñ (Marriage)</div>
      </div>
    </div>

    <!-- Radar + Insight -->
    <div class="card">
      <canvas id="radar" width="320" height="240"></canvas>
      <pre id="insight" style="white-space:pre-wrap;text-align:left;margin:6px auto;max-width:720px">
üúÅ Run Analyze to generate insight‚Ä¶
      </pre>
    </div>
  </div>

<script>
/* ==== Google Translate ==== */
function googleTranslateElementInit(){
  new google.translate.TranslateElement({pageLanguage:'en',
    includedLanguages:'en,si,ta,de,it,ja,hi,zh-CN,fr,es,tr,ru',autoDisplay:false
  },'google_translate_element');
}
function setLangCookie(l){const v='/auto/'+l;document.cookie='googtrans='+v+';path=/';
document.cookie='googtrans='+v+';path=/;domain='+location.hostname;location.reload();}
document.addEventListener('click',e=>{const b=e.target.closest('.langbar button[data-lang]'); if(b) setLangCookie(b.dataset.lang);});
(function(){const s=document.createElement('script');s.src='https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';document.body.appendChild(s);})();

/* ==== Camera ==== */
const video=document.getElementById('video');
const canvas=document.getElementById('canvas'); const ctx=canvas.getContext('2d');
const camBox=document.getElementById('camBox'); const statusBox=document.getElementById('status');
function sizeCanvas(){const r=camBox.getBoundingClientRect();const d=Math.min(window.devicePixelRatio||1,2);canvas.width=r.width*d;canvas.height=r.height*d;}
new ResizeObserver(sizeCanvas).observe(camBox); sizeCanvas();

document.getElementById('startCam').onclick=async()=>{
  try{const stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:'environment'}}); video.srcObject=stream; video.hidden=false; statusBox.textContent='Camera active';}
  catch{alert('Camera access failed');}
};
document.getElementById('capture').onclick=()=>{
  if(!video.srcObject){alert('Start camera first');return;}
  sizeCanvas(); ctx.drawImage(video,0,0,canvas.width,canvas.height); statusBox.textContent='Frame captured';
};
document.getElementById('filePick').onchange=e=>{
  const f=e.target.files[0]; if(!f)return;
  const img=new Image(); img.onload=()=>{sizeCanvas(); ctx.drawImage(img,0,0,canvas.width,canvas.height); statusBox.textContent='Image loaded';};
  img.src=URL.createObjectURL(f);
};

/* ==== Analyzer (demo heuristic) ==== */
const bars=[...Array(7)].map((_,i)=>document.getElementById('b'+i));
document.getElementById('analyze').onclick=()=>{
  const pix=ctx.getImageData(0,0,canvas.width,canvas.height).data;
  if(!pix || !pix.length){alert('Load an image first');return;}
  let sum=0; for(let i=0;i<pix.length;i+=24) sum+=pix[i]+pix[i+1]+pix[i+2];
  const avg=sum/(pix.length/24); const conf=Math.min(99,Math.max(60,avg/4));
  document.getElementById('conf').textContent='Confidence '+conf.toFixed(1)+'%';

  // demo scores (replace with real model output)
  const sc=[80,74,70,60,66,75,55].map(v=>Math.min(100,v+(conf-80)/2));
  sc.forEach((v,i)=>bars[i].style.transform=`scaleX(${v/100})`);
  drawRadar(sc);

  document.getElementById('insight').textContent=
  `Œî Confidence ${conf.toFixed(1)}%
‚Ä¢ Heart ${sc[0]}  ‚Ä¢ Head ${sc[1]}
‚Ä¢ Life  ${sc[2]}  ‚Ä¢ Fate ${sc[3]}
‚Ä¢ Sun   ${sc[4]}  ‚Ä¢ Mercury ${sc[5]}  ‚Ä¢ Marriage ${sc[6]}
Insight: Subtle energy balance emerging.`;
};

/* ==== Radar ==== */
function drawRadar(a){
  const c=document.getElementById('radar'), g=c.getContext('2d');
  const w=c.width,h=c.height,cx=w/2,cy=h/2,R=Math.min(w,h)/2-18;
  g.clearRect(0,0,w,h); g.strokeStyle='#17324a'; g.lineWidth=1;
  for(let r=0.2;r<=1;r+=0.2){ g.beginPath();
    for(let i=0;i<7;i++){const ang=i*2*Math.PI/7-Math.PI/2; const x=cx+Math.cos(ang)*R*r; const y=cy+Math.sin(ang)*R*r; i?g.lineTo(x,y):g.moveTo(x,y);}
    g.closePath(); g.stroke();
  }
  g.beginPath();
  for(let i=0;i<7;i++){const ang=i*2*Math.PI/7-Math.PI/2; const x=cx+Math.cos(ang)*R*(a[i]/100); const y=cy+Math.sin(ang)*R*(a[i]/100); i?g.lineTo(x,y):g.moveTo(x,y);}
  g.closePath(); g.fillStyle='rgba(22,240,167,.12)'; g.fill(); g.strokeStyle='#16f0a7'; g.stroke();
}
</script>
</body>
</html>
