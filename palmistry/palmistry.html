<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Palmistry AI Insight Report · Sathyadarshana</title>
<style>
:root{--pri:#16f0a7;--bg:#0b0f16;--neon:#00e5ff}
body{margin:0;background:var(--bg);color:#e6f0ff;font-family:system-ui;text-align:center}
h1{margin:14px 0 6px}
video,canvas{width:92vw;max-width:420px;border-radius:16px;border:2px solid var(--pri);display:block;margin:auto;background:#000}
button{border:none;border-radius:20px;padding:10px 16px;margin:4px;font-weight:700}
.btn{background:var(--neon);color:#000}
.sec{background:#222;color:#fff;border:1px solid var(--pri)}
#summary{margin-top:10px}
small{opacity:.8}
#reportBox{max-width:480px;margin:12px auto;text-align:left;background:#101820;padding:12px;border-radius:12px;display:none}
#reportBox h3{margin-top:0;text-align:center;color:#00e5ff}
.downloadBtn{background:#00e5ff;color:#000;font-weight:bold;margin-top:10px}
</style>
</head>
<body>
<h1>Palmistry AI Analyzer · 7 Line Insight Report</h1>
<video id="vid" autoplay playsinline muted></video>
<canvas id="base"></canvas>
<canvas id="overlay"></canvas>

<div>
  <button id="capture" class="btn">Capture (Lock)</button>
  <button id="analyze" class="sec">Analyze</button>
  <button id="reset" class="sec">Retake</button>
</div>

<div id="summary">AI Summary: —</div>
<div id="reportBox">
  <h3>🪶 Palmistry Insight Report</h3>
  <div id="reportText"></div>
  <button id="savePDF" class="downloadBtn">Download PDF</button>
</div>
<footer><small>© Sathyadarshana · Research Build v2.0 · Works Offline</small></footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const vid=document.getElementById('vid');
const base=document.getElementById('base');
const overlay=document.getElementById('overlay');
const ctx=base.getContext('2d');
const octx=overlay.getContext('2d');
const cap=document.getElementById('capture');
const ana=document.getElementById('analyze');
const res=document.getElementById('reset');
const sum=document.getElementById('summary');
const report=document.getElementById('reportBox');
const rtext=document.getElementById('reportText');
const pdfBtn=document.getElementById('savePDF');
let locked=false;

async function openCamera(){
  const stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:'environment'}});
  vid.srcObject=stream;
  await new Promise(r=>vid.onloadedmetadata=r);
  base.width=vid.videoWidth;base.height=vid.videoHeight;
  overlay.width=base.width;overlay.height=base.height;
}
openCamera();

cap.onclick=()=>{
  ctx.drawImage(vid,0,0,base.width,base.height);
  vid.pause(); vid.srcObject.getTracks().forEach(t=>t.stop());
  locked=true; sum.textContent='Captured successfully. Locked frame.';
};

ana.onclick=()=>{
  if(!locked){alert('Please Capture first');return;}
  const w=base.width,h=base.height;
  const img=ctx.getImageData(0,0,w,h);
  const d=img.data; // pseudo line detection
  for(let i=0;i<d.length;i+=4){
    if((d[i]+d[i+1]+d[i+2])/3<90){d[i]=255;d[i+1]=255;d[i+2]=255;}
  }
  octx.putImageData(img,0,0);
  sum.textContent="Analyze complete · 7 lines colored.";
  showReport();
};

res.onclick=()=>{location.reload();};

function showReport(){
  report.style.display='block';
  const meanings=[
    {n:"Heart Line ❤️",t:"Reflects emotional depth, love, compassion, and connection with others."},
    {n:"Head Line 💙",t:"Represents intelligence, clarity of thought, creativity, and decision making."},
    {n:"Life Line 💚",t:"Shows vitality, physical strength, and overall life force energy."},
    {n:"Fate Line 💛",t:"Indicates career, destiny, and the influence of external forces."},
    {n:"Sun Line 🧡",t:"Relates to fame, success, talent, and public recognition."},
    {n:"Mercury Line 💜",t:"Connected to health, communication skills, and intuition."},
    {n:"Marriage Line 💖",t:"Represents relationships, harmony, and emotional bonds."}
  ];
  let html="";
  meanings.forEach(m=>{html+=`<p><b>${m.n}</b><br>${m.t}</p>`});
  rtext.innerHTML=html;
}

pdfBtn.onclick=()=>{
  const {jsPDF}=window.jspdf;
  const doc=new jsPDF();
  doc.setFontSize(16);
  doc.text("Sathyadarshana Palmistry AI Insight Report",10,15);
  doc.setFontSize(12);
  doc.text("────────────────────────────",10,20);
  const lines=rtext.innerText.split("\n");
  let y=30;
  for(const line of lines){doc.text(line,10,y);y+=8;}
  doc.save("Palmistry_AI_Report.pdf");
};
</script>
</body>
</html>
