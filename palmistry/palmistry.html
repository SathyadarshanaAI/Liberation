<!DOCTYPE html>
<html lang="si">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Palmistry Universal v4.6.2 ¬∑ Sathyadarshana</title>
<style>
:root{--pri:#16f0a7;--bg:#0b0f16;--neon:#00e5ff}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:#e6f0ff;font-family:system-ui;text-align:center}
h1{margin:14px 0 4px}
small{opacity:.85}
.stage{position:relative;display:inline-block;width:min(92vw,480px)}
#cam{width:100%;border-radius:16px;border:2px solid var(--pri);background:#000;display:block}
#cv{position:absolute;inset:0;width:100%;height:100%;border-radius:16px;display:none;pointer-events:none}
.captureBtn{position:absolute;bottom:18px;left:50%;transform:translateX(-50%);
  width:86px;height:86px;border-radius:50%;border:none;background:#2196f3;color:#000;
  font-weight:700;box-shadow:0 0 15px #2196f333;cursor:pointer}
.btns{margin:10px 0;display:flex;gap:8px;justify-content:center;flex-wrap:wrap}
button,.btnLike{border:none;border-radius:10px;padding:.6em 1em;font-weight:700;cursor:pointer}
.left{background:#16243a;color:#cfe9ff}
.an{background:#16f0a7;color:#062}
.cap{background:#fbbf24;color:#111}
.torch{background:#22c55e;color:#021}
.speak{background:#60a5fa;color:#021}
.report{background:#a78bfa;color:#120}
select.btnLike,input[type=file].btnLike{background:#19283f;color:#cfe9ff}
.sliderRow{display:flex;gap:12px;justify-content:center;align-items:center;flex-wrap:wrap;margin:10px 0 6px}
.sliderRow label{display:flex;gap:8px;align-items:center}
input[type=range]{accent-color:#16f0a7}
#status{margin:8px auto 0;padding:10px;border:1px dashed #355;border-radius:10px;color:#cfe;max-width:860px;display:none;white-space:pre-wrap;text-align:left}
#summary{max-width:860px;margin:10px auto;text-align:left;background:#0f1420;border:1px solid #243e60;border-radius:12px;padding:12px;display:none}
#summary h3{margin:0 0 8px}
.tag{display:inline-block;margin-right:8px;margin-bottom:6px;padding:3px 8px;border-radius:999px;border:1px solid #2a4b72;background:#0d1a2c;color:#9fd6ff}
.legend{display:flex;gap:8px;justify-content:center;margin:6px 0 0}
.dot{width:12px;height:12px;border-radius:50%;display:inline-block;margin-right:6px}
.heart{background:#ff3b3b}.head{background:#ffa533}.life{background:#42ff6c}
footer{color:#16f0a7;margin:12px 0 22px;font-size:.9em}
</style>
</head>
<body>
<h1>üñêÔ∏è Palmistry Universal v4.6.2</h1>
<small>Align palm ‚Üí Capture ‚Üí Analyze ‚Üí Speak/Save</small>

<div class="stage">
  <video id="cam" autoplay playsinline muted></video>
  <canvas id="cv"></canvas>
  <button class="captureBtn" id="capBtn">Capture</button>
</div>

<div class="legend">
  <span class="tag"><span class="dot heart"></span>Heart</span>
  <span class="tag"><span class="dot head"></span>Head</span>
  <span class="tag"><span class="dot life"></span>Life</span>
</div>

<div class="btns">
  <button class="btnLike" id="startBtn">‚ñ∂Ô∏è Start</button>
  <select id="camsel" class="btnLike"></select>
  <button class="btnLike" id="cycleBtn">üîÅ Cycle</button>

  <select id="resSel" class="btnLike">
    <option value="1280x720">HD 1280√ó720</option>
    <option value="1920x1080">FullHD 1920√ó1080</option>
    <option value="640x480">VGA 640√ó480</option>
  </select>
  <select id="fpsSel" class="btnLike">
    <option value="30">30 FPS</option>
    <option value="60">60 FPS</option>
    <option value="24">24 FPS</option>
  </select>

  <input id="pick" type="file" accept="image/*" class="btnLike"/>
  <button class="left" id="flipBtn">‚ÜîÔ∏è Flip</button>
  <button class="torch" id="torchBtn" hidden>üî¶ Torch</button>
  <label class="btnLike" style="display:flex;align-items:center;gap:8px">
    Zoom <input id="zoom" type="range" min="1" max="1" step="0.1" value="1" style="width:120px">
  </label>

  <button class="an" id="anBtn">‚ú® Analyze</button>
  <button class="speak" id="speakBtn">üéß Speak</button>
  <button class="cap" id="saveBtn">üíæ Save</button>
  <button class="report" id="reportBtn">üìÑ Open Report</button>
  <button class="btnLike" id="clearBtn">üßπ Clear</button>
</div>

<div class="sliderRow">
  <label>Edge <input id="edge" type="range" min="40" max="110" value="75"></label>
  <label>Detail <input id="gk" type="range" min="1" max="5" value="3"></label>
</div>

<div id="status"></div>
<div id="summary">
  <h3>üîé AI Summary</h3>
  <div id="sumtext"></div>
</div>

<footer>¬© 2025 Sathyadarshana ¬∑ Palmistry AI Overlay</footer>

<script>
/* ===== refs ===== */
const video=document.getElementById('cam'), cv=document.getElementById('cv'), ctx=cv.getContext('2d');
const startBtn=id('startBtn'), camsel=id('camsel'), cycleBtn=id('cycleBtn'),
      resSel=id('resSel'), fpsSel=id('fpsSel'), zoomEl=id('zoom'),
      pick=id('pick'), flipBtn=id('flipBtn'), torchBtn=id('torchBtn'),
      capBtn=id('capBtn'), anBtn=id('anBtn'), speakBtn=id('speakBtn'),
      saveBtn=id('saveBtn'), reportBtn=id('reportBtn'), clearBtn=id('clearBtn');
let stream=null, track=null, captured=false, isMirrored=false;
let camList=[], camIndex=0, lastMetrics=null;

function id(x){return document.getElementById(x)}
function msg(t){ const s=id('status'); s.textContent=t; s.style.display='block'; }
function showSummary(html){ const b=id('summary'); id('sumtext').innerHTML=html; b.style.display='block'; }
function parseRes(v){const [w,h]=v.split('x').map(Number);return {w,h};}

/* ===== NEW: performance guard for big photos (FullHD/4K) ===== */
function normalizeForAnalysis(maxW=1280, maxPx=1_500_000) {
  // keep aspect; clamp to <= ~1.5MP
  const needShrink = () => (cv.width>maxW) || (cv.width*cv.height>maxPx);
  if (!needShrink()) return;
  const s = Math.min(maxW/cv.width, Math.sqrt(maxPx/(cv.width*cv.height)));
  const w = Math.max( Math.round(cv.width * s), 540 );
  const h = Math.round(cv.height * s);
  const tmp = document.createElement('canvas');
  tmp.width=w; tmp.height=h;
  tmp.getContext('2d').drawImage(cv,0,0,w,h);
  cv.width=w; cv.height=h;
  ctx.drawImage(tmp,0,0);
}

/* ===== camera core ===== */
async function ensurePermission(){
  if (!navigator.mediaDevices?.getUserMedia) throw new Error('Browser does not support camera.');
  try{ const t=await navigator.mediaDevices.getUserMedia({video:true,audio:false}); t.getTracks().forEach(tt=>tt.stop()); }
  catch(e){ throw new Error('Permission denied/unavailable: '+e.message); }
}
async function listCams(){
  const devs=await navigator.mediaDevices.enumerateDevices();
  camList=devs.filter(d=>d.kind==='videoinput')
              .sort((a,b)=>(/back|rear|environment|wide/i.test(a.label)?-1:1));
  camsel.innerHTML='';
  camList.forEach((c,i)=>{const o=document.createElement('option');o.value=c.deviceId;o.textContent=c.label||`Camera ${i+1}`;camsel.appendChild(o);});
  camIndex=0; camsel.selectedIndex=0;
}
async function startCam(deviceId=null){
  if(stream){stream.getTracks().forEach(t=>t.stop()); stream=null; track=null;}
  const {w,h}=parseRes(resSel.value||'1280x720'); const fps=Number(fpsSel.value||30);
  const facing=isMirrored?'user':'environment';
  const constraints={ video: deviceId?{deviceId:{exact:deviceId}}:{facingMode:{ideal:facing}}, audio:false };
  Object.assign(constraints.video,{
    width:{ideal:w,max:w},height:{ideal:h,max:h},frameRate:{ideal:fps,max:fps},
    advanced:[{focusMode:'continuous'},{exposureMode:'continuous'}]
  });
  try{ stream=await navigator.mediaDevices.getUserMedia(constraints); }
  catch(e){
    msg('‚ö†Ô∏è exact constraint failed, retrying with generic video‚Ä¶');
    try{ stream=await navigator.mediaDevices.getUserMedia({video:true,audio:false}); }
    catch(err){ msg('‚ùå Camera error: '+err.message); return; }
  }
  video.srcObject=stream; await video.play();
  track=stream.getVideoTracks()[0];

  const W=video.videoWidth||w, H=video.videoHeight||h;
  cv.width=W; cv.height=H;
  video.style.transform=isMirrored?'scaleX(-1)':'none';
  cv.style.display=captured?'block':'none';

  const caps=track.getCapabilities?.()||{};
  torchBtn.hidden=!('torch' in caps);
  if('zoom' in caps){
    zoomEl.min=caps.zoom.min||1; zoomEl.max=caps.zoom.max||5; zoomEl.step=caps.zoom.step||0.1;
    zoomEl.value=(track.getSettings?.().zoom)||zoomEl.min; zoomEl.parentElement.style.display='';
  }else{ zoomEl.parentElement.style.display='none'; }

  msg(`üì∑ ${track.label||'Camera'} ‚Ä¢ ${W}√ó${H}@${fps} ‚Ä¢ Tap Capture ‚Üí Analyze`);
}

/* ui */
startBtn.onclick = async ()=>{
  try{
    if (location.protocol!=='https:' && location.hostname!=='localhost'){
      msg('üîí Enable HTTPS. Some devices block camera on HTTP.');
    }
    await ensurePermission(); await listCams();
    await startCam(camsel.value||camList[0]?.deviceId||null);
  }catch(e){ msg('‚ùå '+(e.message||e)); }
};
cycleBtn.onclick = async ()=>{ if(!camList.length) await listCams(); if(!camList.length) return msg('No cameras detected.'); camIndex=(camIndex+1)%camList.length; camsel.selectedIndex=camIndex; await startCam(camList[camIndex].deviceId); };
camsel.onchange = async ()=> startCam(camsel.value);
resSel.onchange  = async ()=> startCam(camsel.value||null);
fpsSel.onchange  = async ()=> startCam(camsel.value||null);
flipBtn.onclick  = async ()=>{ isMirrored=!isMirrored; if(stream&&!captured){ video.style.transform=isMirrored?'scaleX(-1)':'none'; await startCam(camsel.value||null);} else if(captured){ mirrorCanvas(); } };
torchBtn.onclick = async ()=>{ if(!track) return; try{ const now=(track.getSettings?.().torch)||false; await track.applyConstraints({advanced:[{torch:!now}]}); }catch(e){ msg('Torch error: '+e.message); } };
zoomEl.oninput   = async ()=>{ if(!track) return; try{ await track.applyConstraints({advanced:[{zoom:Number(zoomEl.value)}]}); }catch{} };

function mirrorCanvas(){ const t=document.createElement('canvas'); t.width=cv.width; t.height=cv.height; t.getContext('2d').drawImage(cv,0,0); ctx.save(); ctx.setTransform(-1,0,0,1,cv.width,0); ctx.drawImage(t,0,0); ctx.restore(); }

/* capture / file */
capBtn.onclick = async ()=>{
  if(!stream) await startCam(camsel.value||null);
  if(!video.videoWidth) await new Promise(r=>setTimeout(r,120));
  cv.width=video.videoWidth; cv.height=video.videoHeight;
  ctx.save(); if(isMirrored){ ctx.translate(cv.width,0); ctx.scale(-1,1); }
  ctx.drawImage(video,0,0,cv.width,cv.height); ctx.restore();
  normalizeForAnalysis(1280, 1_500_000);
  cv.style.display='block'; captured=true; lastMetrics=null; id('summary').style.display='none';
  msg('üñêÔ∏è Photo locked. ‚ú® Analyze ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.');
};
pick.onchange = e=>{
  const f=e.target.files?.[0]; if(!f) return;
  const img=new Image(); img.onload=()=>{
    cv.width=img.naturalWidth; cv.height=img.naturalHeight; ctx.drawImage(img,0,0);
    if(isMirrored) mirrorCanvas();
    normalizeForAnalysis(1280, 1_500_000);
    cv.style.display='block'; captured=true; lastMetrics=null; id('summary').style.display='none';
    msg('üñºÔ∏è Photo loaded. ‚ú® Analyze.');
  }; img.onerror=()=>msg('‚ùå Image load failed.'); img.src=URL.createObjectURL(f);
};
clearBtn.onclick = ()=>{ ctx.clearRect(0,0,cv.width,cv.height); captured=false; cv.style.display='none'; lastMetrics=null; id('summary').style.display='none'; msg('üßπ Cleared. Ready.'); };

/* save / report */
saveBtn.onclick = ()=>{ if(!captured) return msg('Capture/Load first.'); const data=cv.toDataURL('image/png'); const a=document.createElement('a'); a.href=data; a.download='palm_'+Date.now()+'.png'; a.click(); msg('üíæ Saved.'); };
reportBtn.onclick = ()=>{
  if(!captured){ msg('Capture first'); return; }
  const data=cv.toDataURL('image/png'); const s=lastMetrics?buildSummaryHTML(lastMetrics):'<p>Run Analyze first to get AI summary.</p>';
  const w=window.open('','_blank'); w.document.write(`<html><head><title>Palmistry Report</title>
  <style>body{font-family:system-ui;padding:12px;color:#123}h2{margin:6px 0}.box{border:1px solid #ccd;padding:10px;border-radius:10px}img{max-width:100%}</style></head>
  <body><h2>üñêÔ∏è Palmistry Report</h2><div class="box"><img src="${data}"/></div><div class="box">${s}</div><p><em>Tip:</em> Print ‚Üí Save as PDF.</p></body></html>`); w.document.close();
};

/* ===== Analyze with memory guards ===== */
anBtn.onclick = ()=>{
  if(!captured) return msg('‚ùó‡∂¥‡∑Ö‡∂∏‡∑î‡∑Ä Capture ‡∑Ñ‡∑ù Choose Photo ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.');
  msg('‚è≥ Analyzing‚Ä¶ (FullHD downscaled for speed)');
  setTimeout(()=>{ try{ analyzePureJS(); } catch(e){ console.error(e); msg('‚ùå Analyze failed: '+(e.message||e)); } }, 50);
};

function analyzePureJS(){
  if(!cv.width || !cv.height){ msg('‚ö†Ô∏è No image on canvas'); return; }
  // extra guard: shrink again if needed
  normalizeForAnalysis(1024, 1_000_000);

  let w=cv.width, h=cv.height;
  let src;
  for(let tries=0; tries<3; tries++){
    try{ src = ctx.getImageData(0,0,w,h); break; }
    catch(e){
      const t=document.createElement('canvas');
      t.width=Math.round(w*0.75); t.height=Math.round(h*0.75);
      t.getContext('2d').drawImage(cv,0,0,t.width,t.height);
      cv.width=t.width; cv.height=t.height; ctx.drawImage(t,0,0);
      w=cv.width; h=cv.height;
      if(tries===2){ msg('‚ùå Analyze failed (memory). Try HD 1280√ó720 or lower.'); return; }
    }
  }

  const edgeVal=parseInt(id('edge').value,10)/255;
  const passes=parseInt(id('gk').value,10);

  // grayscale
  const d=src.data, gray=new Uint8ClampedArray(w*h);
  for(let i=0,j=0;i<d.length;i+=4,j++) gray[j]=d[i]*.299+d[i+1]*.587+d[i+2]*.114;

  // blur 3x3
  let a=Float32Array.from(gray); const k=[1,2,1,2,4,2,1,2,1],n=16;
  for(let p=0;p<passes;p++){ const t=new Float32Array(w*h);
    for(let y=1;y<h-1;y++) for(let x=1;x<w-1;x++){ let s=0,i=0;
      for(let dy=-1;dy<=1;dy++) for(let dx=-1;dx<=1;dx++) s+=a[(y+dy)*w+(x+dx)]*k[i++]; t[y*w+x]=s/n; }
    a=t;
  }
  const blur=Uint8ClampedArray.from(a);

  // sobel
  const mag=new Float32Array(w*h); let mx=1;
  for(let y=1;y<h-1;y++) for(let x=1;x<w-1;x++){ const i=y*w+x;
    const gx=-blur[i-w-1]-2*blur[i-1]-blur[i+w-1]+blur[i-w+1]+2*blur[i+1]+blur[i+w+1];
    const gy=-blur[i-w-1]-2*blur[i-w]-blur[i-w+1]+blur[i+w-1]+2*blur[i+w]+blur[i+w+1];
    const m=Math.hypot(gx,gy); mag[i]=m; if(m>mx) mx=m;
  }
  const T=edgeVal*mx; const bin=new Uint8ClampedArray(w*h); for(let i=0;i<w*h;i++) bin[i]=mag[i]>T?1:0;

  // skeletonize
  const sk=Uint8Array.from(bin); let changed=true,pass=0;
  const N=(x,y)=>sk[(y-1)*w+x]+sk[(y-1)*w+x+1]+sk[y*w+x+1]+sk[(y+1)*w+x+1]+sk[(y+1)*w+x]+sk[(y+1)*w+x-1]+sk[y*w+x-1]+sk[(y-1)*w+x-1];
  const S=(x,y)=>{ const p=[sk[(y-1)*w+x],sk[(y-1)*w+x+1],sk[y*w+x+1],sk[(y+1)*w+x+1],sk[(y+1)*w+x],sk[(y+1)*w+x-1],sk[y*w+x-1],sk[(y-1)*w+x-1]];
    let t=0; for(let i=0;i<8;i++) if(p[i]==0&&p[(i+1)%8]==1) t++; return t; };
  while(changed&&pass<25){ changed=false; const rem=[];
    for(let y=1;y<h-1;y++)for(let x=1;x<w-1;x++){ const i=y*w+x;if(!sk[i])continue;const nn=N(x,y),s=S(x,y);
      if(nn>=2&&nn<=6&&s==1&&(sk[(y-1)*w+x]*sk[y*w+x+1]*sk[(y+1)*w+x]==0)&&(sk[y*w+x+1]*sk[y*w+x-1]*sk[(y-1)*w+x]==0)) rem.push(i);}
    rem.forEach(i=>sk[i]=0); if(rem.length)changed=true; rem.length=0;
    for(let y=1;y<h-1;y++)for(let x=1;x<w-1;x++){ const i=y*w+x;if(!sk[i])continue;const nn=N(x,y),s=S(x,y);
      if(nn>=2&&nn<=6&&s==1&&(sk[(y-1)*w+x]*sk[y*w+x-1]*sk[(y+1)*w+x]==0)&&(sk[(y-1)*w+x]*sk[y*w+x+1]*sk[y*w+x-1]==0)) rem.push(i);}
    rem.forEach(i=>sk[i]=0); if(rem.length)changed=true; pass++;
  }

  const yH0=0, yH1=Math.floor(h*0.30), yD0=yH1, yD1=Math.floor(h*0.55), yL0=yD1, yL1=h;
  function pickLongest(y0,y1){
    const seen=new Uint8Array(w*h); const NB=[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]];
    let best=[]; function walk(sx,sy){ const st=[[sx,sy]], pts=[]; seen[sy*w+sx]=1;
      while(st.length){ const [x,y]=st.pop(); pts.push([x,y]);
        for(const [dx,dy] of NB){ const nx=x+dx, ny=y+dy, id=ny*w+nx;
          if(nx>0&&ny>y0&&nx<w-1&&ny<y1-1 && !seen[id] && sk[id]){ seen[id]=1; st.push([nx,ny]); } } }
      return pts; }
    for(let y=y0+1;y<y1-1;y++) for(let x=1;x<w-1;x++){ const i=y*w+x; if(sk[i]){ const pts=walk(x,y); if(pts.length>best.length) best=pts; } }
    return best;
  }
  const pHeart=pickLongest(yH0,yH1), pHead=pickLongest(yD0,yD1), pLife=pickLongest(yL0,yL1);

  // overlay edges faint
  const overlay = ctx.createImageData(w,h);
  for(let i=0,j=0;i<w*h;i++,j+=4) if(bin[i]){ overlay.data[j]=0; overlay.data[j+1]=255; overlay.data[j+2]=255; overlay.data[j+3]=85; }
  ctx.putImageData(overlay,0,0);

  drawPath(pHeart,'#ff3b3b',4);
  drawPath(pHead ,'#ffa533',4);
  drawPath(pLife ,'#42ff6c',4);

  const M = (pts,name)=>({ name, len:polyLen(pts), slope:estSlope(pts), gaps:countGaps(pts) });
  lastMetrics = { heart:M(pHeart,'Heart'), head:M(pHead,'Head'), life:M(pLife,'Life'), lang:'si' };
  const html = buildSummaryHTML(lastMetrics);
  showSummary(html);
  msg('‚ú® Analyze done');
}

/* helpers */
function drawPath(pts,color,wid){
  if(!pts || pts.length<6) return;
  ctx.lineJoin='round'; ctx.lineCap='round';
  ctx.strokeStyle='#000'; ctx.lineWidth=wid+2; ctx.beginPath();
  ctx.moveTo(pts[0][0],pts[0][1]); for(const [x,y] of pts) ctx.lineTo(x,y); ctx.stroke();
  ctx.strokeStyle=color; ctx.lineWidth=wid; ctx.beginPath();
  ctx.moveTo(pts[0][0],pts[0][1]); for(const [x,y] of pts) ctx.lineTo(x,y); ctx.stroke();
}
function polyLen(pts){ let L=0; for(let i=1;i<pts.length;i++){ const dx=pts[i][0]-pts[i-1][0], dy=pts[i][1]-pts[i-1][1]; L+=Math.hypot(dx,dy); } return L; }
function estSlope(pts){ if(pts.length<2) return 0; const a=pts[0], b=pts[pts.length-1]; return Math.atan2(b[1]-a[1], b[0]-a[0]); }
function countGaps(pts){ let g=0; for(let i=2;i<pts.length;i++) if(Math.hypot(pts[i][0]-pts[i-1][0], pts[i][1]-pts[i-1][1])>6) g++; return g; }
function grade(len,gaps){ if(len<80) return 'weak'; if(gaps>15) return 'fragmented'; return len>220 ? 'strong' : 'moderate'; }
function orientWords(rad){ const deg = rad*180/Math.PI; if(deg<-25) return 'tilt-up'; if(deg>25) return 'tilt-down'; return 'level'; }
function buildSummaryHTML(m){
  const hG=grade(m.heart.len,m.heart.gaps), dG=grade(m.head.len,m.head.gaps), lG=grade(m.life.len,m.life.gaps);
  const heart= `‚ù§Ô∏è ‡∑Ñ‡∑ò‡∂Ø ‡∂ª‡∑ö‡∂õ‡∑è‡∑Ä: <b>${hG}</b> (${orientWords(m.heart.slope)}), ‡∂Ø‡∑í‡∂ú ~${m.heart.len|0}, gaps ${m.heart.gaps}.`;
  const head = `üß° ‡∑Å‡∑í‡∂ª‡∑É‡∑ä ‡∂ª‡∑ö‡∂õ‡∑è‡∑Ä: <b>${dG}</b> (${orientWords(m.head.slope)}), ‡∂Ø‡∑í‡∂ú ~${m.head.len|0}, gaps ${m.head.gaps}.`;
  const life = `üíö ‡∂¢‡∑ì‡∑Ä ‡∂ª‡∑ö‡∂õ‡∑è‡∑Ä: <b>${lG}</b>, ‡∂Ø‡∑í‡∂ú ~${m.life.len|0}, gaps ${m.life.gaps}.`;
  const si = `<p>${heart}<br>${head}<br>${life}</p><p>üìù ‡∑ÄËß£: <i>${explainSi(hG,dG,lG)}</i></p>`;
  const en = `<p>Heart line: <b>${hG}</b> (${orientWords(m.heart.slope)}). Head line: <b>${dG}</b>. Life line: <b>${lG}</b>.</p><p><i>${explainEn(hG,dG,lG)}</i></p>`;
  m.summarySi = si; m.summaryEn = en; return si + '<hr/>' + en;
}
function explainSi(h,d,l){
  let t=[]; if(h==='strong') t.push('‡∑Ä‡∑ô‡∂ª‡∂Ø‡∑è‡∂ª‡∑ì ‡∂ö‡∑è‡∂ª‡∑î‡∂´‡∑í‡∂ö ‡∑É‡∑ä‡∑Ä‡∂∑‡∑è‡∑Ä‡∂∫, ‡∂±‡∑ë‡∂Ø‡∑ë ‡∂≠‡∂±‡∑ä‡∑Ñ‡∑è‡∑Ä ‡∑Ä‡∑ê‡∂©‡∑í.');
  if(h==='weak') t.push('‡∂∑‡∑è‡∑Ä‡∂±‡∑è‡∑Ä ‡∂¥‡∑è‡∂Ω‡∂±‡∂∫‡∂ß ‡∂Ö‡∑Ä‡∂∞‡∑è‡∂±‡∂∫ ‡∂Ø‡∑ô‡∂±‡∑ä‡∂±.');
  if(d==='strong') t.push('‡∂≠‡∑ì‡∂ª‡∂´ ‡∂ú‡∑ê‡∂±‡∑ì‡∂∏ ‡∂¥‡∑ê‡∑Ñ‡∑ê‡∂Ø‡∑í‡∂Ω‡∑í, ‡∂¥‡∑ä‚Äç‡∂ª‡∑è‡∂∫‡∑ù‡∂ú‡∑í‡∂ö ‡∂∂‡∑î‡∂Ø‡∑ä‡∂∞‡∑í‡∂∫ ‡∑Ñ‡∑ú‡∂≥‡∂∫‡∑í.');
  if(d==='fragmented') t.push('‡∂Ö‡∂∞‡∑í‡∂ö multitask ‡∂±‡∑ê‡∂≠‡∑í‡∑Ä ‡∑Ä‡∑ê‡∂© ‡∑É‡∑ê‡∂Ω‡∑É‡∑î‡∂∏‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.');
  if(l==='strong') t.push('‡∑Å‡∂ö‡∑ä‡∂≠‡∑í‡∂∫/‡∂Ø‡∑ò‡∂™‡∂ö‡∂∏ ‡∂â‡∑Ñ‡∑Ö, ‡∂Ø‡∑í‡∂ú‡∑î ‡∂Ü‡∂∫‡∑î‡∂Ø ‡∂ö‡∑è‡∂∫‡∑í‡∂ö ‡∑Å‡∂ö‡∑ä‡∂≠‡∑í‡∂∫.');
  if(l==='weak') t.push('‡∑Ä‡∑í‡∑Ä‡∑ö‡∂ö, ‡∂±‡∑í‡∂Ø‡•ç‡§∞‡§æ, ‡∂¢‡∂Ω‡∂∫ ‡∑Ä‡∑ê‡∂©‡∑í‡∂ö‡∂ª‡∂±‡∑ä‡∂±.'); return t.join(' ');
}
function explainEn(h,d,l){
  let t=[]; if(h==='strong') t.push('Warm, empathetic nature; bonds deeply with people.');
  if(h==='weak') t.push('Work on emotional balance & boundaries.');
  if(d==='strong') t.push('Clear thinker and practical problem-solver.');
  if(d==='fragmented') t.push('Reduce context switching; plan tasks carefully.');
  if(l==='strong') t.push('Good vitality and resilience; steady stamina.');
  if(l==='weak') t.push('Prioritize rest, sleep and hydration.'); return t.join(' ');
}

window.addEventListener('load', ()=>{
  msg('‚ñ∂Ô∏è Start ‚Üí Allow camera. If black: Menu ‚Üí Site settings ‚Üí Camera ‚Üí Allow. Use HTTPS.');
});
</script>
</body>
</html>
