// modules/analyzer.js

/**
 * Generate a Full AI Palmistry Report (returns Markdown/HTML string)
 * @param {object|null} leftHandData
 * @param {object|null} rightHandData
 * @param {string} [language='en']
 * @param {string} [version='5.1']
 * @returns {string}
 */
export function generateFullAIReport(leftHandData, rightHandData, language = 'en', version = '5.1') {
    const notProvided = '<span style="color:#888;">Not Provided</span>';

    function section(title, body) {
        return `<h2>${title}</h2>\n${body}\n`;
    }

    function block(title, value) {
        return `<b>${title}</b><br>${value || notProvided}<br>`;
    }

    // 1. Left Hand (Past Lives)
    let leftSection = '';
    if (leftHandData) {
        leftSection += block("Karmic Patterns", leftHandData.karma);
        leftSection += block("Spiritual Tendencies", leftHandData.spiritual);
        leftSection += block("Inherited Talents & Challenges", leftHandData.talents);
        leftSection += block("Significant Past Life Events", leftHandData.events);
        leftSection += block("Comparison with Global Data", leftHandData.globalCompare);
    } else {
        leftSection = notProvided;
    }

    // 2. Right Hand (Current & Future)
    let rightSection = '';
    if (rightHandData) {
        rightSection += block("Personality & Current Path", rightHandData.personality);
        rightSection += block("Health Indicators", rightHandData.health);
        rightSection += block("Career & Success", rightHandData.career);
        rightSection += block("Relationships", rightHandData.relationships);
        rightSection += block("Future Trends", rightHandData.future);
        rightSection += block("Comparison with Global Data", rightHandData.globalCompare);
    } else {
        rightSection = notProvided;
    }

    // 3. Comparative Insights
    let compareSection = '';
    if (leftHandData && rightHandData) {
        compareSection = block("Past & Present/Future Balance", leftHandData.comparative || "Your past life patterns are influencing your current and future experiences.");
    } else {
        compareSection = notProvided;
    }

    // 4. Special Marks
    let marksSection = '';
    marksSection += block("Left Hand Special Marks", leftHandData?.specialMarks);
    marksSection += block("Right Hand Special Marks", rightHandData?.specialMarks);

    // 5. Expert Note
    const noteSection = `
<b>Expert Note:</b>
This report is generated by AI using advanced palmistry and the latest global data. 
For the best results, keep your software up-to-date and use the <b>Speak</b> feature for deeper clarification.<br>
<span style="font-size:small;color:#888;">
Version: ${version} | Language: ${language === 'en' ? 'English' : language}
</span>
`;

    // Final Report (HTML/Markdown)
    return `
<h1>Sathya Darshana Quantum Palm Analyzer V${version}</h1>
<h3>Full AI Palmistry Report</h3>
${section('1. LEFT HAND – Past Lives Analysis', leftSection)}
${section('2. RIGHT HAND – Current Life & Future Predictions', rightSection)}
${section('3. Comparative Insights', compareSection)}
${section('4. Special Marks and Rare Signs', marksSection)}
${section('5. Expert Note', noteSection)}
    `;
}
